<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Captcha Verify</title>
    <style>
      #dis{
        display: flex;
      } 
    </style>
</head>
<body>
     <div class="main"></div>
    <p id="ques"></p>
    <div id="dis">
        <p id="num1"></p>
        <p id="op"></p>
        <p id="num2"></p>
        <p id="arr"></p>
    </div>
    <input type="number" id="res">
    <button id="verify">Verify</button>
    <p id="res1"></p>
    </div>
</body>
<script>
   
let finalAnswer;

document.getElementById("verify").addEventListener("click", checkAnswer);
captcha();

function captcha() {
    const qno = Math.floor(Math.random() * 3) + 1;

    document.getElementById("res").value = "";
    document.getElementById("res1").innerHTML = "";

    if (qno === 1) {
        setupExpressionCaptcha();
    } else if (qno === 2) {
        setupArrayCaptcha("first");
    } else if (qno === 3) {
        setupArrayCaptcha("last");
    }
}

function setupExpressionCaptcha() {
    document.getElementById("ques").innerHTML = "Evaluate the following expression";
    document.getElementById("arr").innerHTML = "";

    let num1 = Math.floor(Math.random() * 10);
    let num2 = Math.floor(Math.random() * 10);
    const op = Math.floor(Math.random() * 4) + 1;

    let operator;
    switch (op) {
        case 1:
            operator = "+";
            finalAnswer = num1 + num2;
            break;
        case 2:
            operator = "-";
            if (num2 > num1) [num1, num2] = [num2, num1];
            finalAnswer = num1 - num2;
            break;
        case 3:
            operator = "*";
            finalAnswer = num1 * num2;
            break;
        case 4:
            operator = "/";
            if (num2 === 0) num2 = 1; // Prevent divide by zero
            if (num2 > num1) [num1, num2] = [num2, num1];
            finalAnswer = parseFloat((num1 / num2).toFixed(2)); // Rounded
            break;
    }

    document.getElementById("num1").innerHTML = num1;
    document.getElementById("num2").innerHTML = num2;
    document.getElementById("op").innerHTML = operator;
}

function setupArrayCaptcha(position) {
    const randomArray = Array.from({ length: 5 }, () => Math.floor(Math.random() * 10) + 1);
    document.getElementById("arr").innerHTML = randomArray.join("  ");
    document.getElementById("num1").innerHTML = "";
    document.getElementById("num2").innerHTML = "";
    document.getElementById("op").innerHTML = "";

    document.getElementById("ques").innerHTML = `Enter the ${position} characters as in Image`;

    finalAnswer = position === "first" ? randomArray[0] : randomArray[4];
}

function checkAnswer() {
    const userValue = parseFloat(document.getElementById("res").value);
    if (userValue === finalAnswer) {
        document.getElementById("res1").innerHTML = "&#10004 Verified";
         setInterval(function change(){
         document.getElementById("res1").style.color="green";
        
       },100)
       setInterval(function change(){
         document.getElementById("res1").style.color="black";
        
       },200)
    } else {
        document.getElementById("res1").innerHTML = "&#10006 Not Verified";
         setInterval(function change(){
         document.getElementById("res1").style.color="red";
        
       },100)
       setInterval(function change(){
         document.getElementById("res1").style.color="black";
        
       },200)
        setTimeout(captcha, 1000); // Delay to prevent spamming
    }
}
</script>

</html>
